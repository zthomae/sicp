<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>2.64&nbsp;Exercise 2.64</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">zthomae&rsquo;s SICP solutions</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Chapter_1.html" class="tocviewlink" data-pltdoc="x">Chapter 1</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Chapter_2.html" class="tocviewselflink" data-pltdoc="x">Chapter 2</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Chapter_3.html" class="tocviewlink" data-pltdoc="x">Chapter 3</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>2&nbsp;</td><td><a href="Chapter_2.html" class="tocviewlink" data-pltdoc="x">Chapter 2</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="c2e1.html" class="tocviewlink" data-pltdoc="x">Exercise 2.1</a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="c2e2.html" class="tocviewlink" data-pltdoc="x">Exercise 2.2</a></td></tr><tr><td align="right">2.3&nbsp;</td><td><a href="c2e3.html" class="tocviewlink" data-pltdoc="x">Exercise 2.3</a></td></tr><tr><td align="right">2.4&nbsp;</td><td><a href="c2e4.html" class="tocviewlink" data-pltdoc="x">Exercise 2.4</a></td></tr><tr><td align="right">2.5&nbsp;</td><td><a href="c2e5.html" class="tocviewlink" data-pltdoc="x">Exercise 2.5</a></td></tr><tr><td align="right">2.6&nbsp;</td><td><a href="c2e6.html" class="tocviewlink" data-pltdoc="x">Exercise 2.6</a></td></tr><tr><td align="right">2.7&nbsp;</td><td><a href="c2e7.html" class="tocviewlink" data-pltdoc="x">Exercise 2.7</a></td></tr><tr><td align="right">2.8&nbsp;</td><td><a href="c2e8.html" class="tocviewlink" data-pltdoc="x">Exercise 2.8</a></td></tr><tr><td align="right">2.9&nbsp;</td><td><a href="c2e9.html" class="tocviewlink" data-pltdoc="x">Exercise 2.9</a></td></tr><tr><td align="right">2.10&nbsp;</td><td><a href="c2e10.html" class="tocviewlink" data-pltdoc="x">Exercise 2.10</a></td></tr><tr><td align="right">2.11&nbsp;</td><td><a href="c2e11.html" class="tocviewlink" data-pltdoc="x">Exercise 2.11</a></td></tr><tr><td align="right">2.12&nbsp;</td><td><a href="c2e12.html" class="tocviewlink" data-pltdoc="x">Exercise 2.12</a></td></tr><tr><td align="right">2.13&nbsp;</td><td><a href="c2e13.html" class="tocviewlink" data-pltdoc="x">Exercise 2.13</a></td></tr><tr><td align="right">2.14&nbsp;</td><td><a href="c2e14.html" class="tocviewlink" data-pltdoc="x">Exercise 2.14</a></td></tr><tr><td align="right">2.15&nbsp;</td><td><a href="c2e15.html" class="tocviewlink" data-pltdoc="x">Exercise 2.15</a></td></tr><tr><td align="right">2.16&nbsp;</td><td><a href="c2e16.html" class="tocviewlink" data-pltdoc="x">Exercise 2.16</a></td></tr><tr><td align="right">2.17&nbsp;</td><td><a href="c2e17.html" class="tocviewlink" data-pltdoc="x">Exercise 2.17</a></td></tr><tr><td align="right">2.18&nbsp;</td><td><a href="c2e18.html" class="tocviewlink" data-pltdoc="x">Exercise 2.18</a></td></tr><tr><td align="right">2.19&nbsp;</td><td><a href="c2e19.html" class="tocviewlink" data-pltdoc="x">Exercise 2.19</a></td></tr><tr><td align="right">2.20&nbsp;</td><td><a href="c2e20.html" class="tocviewlink" data-pltdoc="x">Exercise 2.20</a></td></tr><tr><td align="right">2.21&nbsp;</td><td><a href="c2e21.html" class="tocviewlink" data-pltdoc="x">Exercise 2.21</a></td></tr><tr><td align="right">2.22&nbsp;</td><td><a href="c2e22.html" class="tocviewlink" data-pltdoc="x">Exercise 2.22</a></td></tr><tr><td align="right">2.23&nbsp;</td><td><a href="c2e23.html" class="tocviewlink" data-pltdoc="x">Exercise 2.23</a></td></tr><tr><td align="right">2.24&nbsp;</td><td><a href="c2e24.html" class="tocviewlink" data-pltdoc="x">Exercise 2.24</a></td></tr><tr><td align="right">2.25&nbsp;</td><td><a href="c2e25.html" class="tocviewlink" data-pltdoc="x">Exercise 2.25</a></td></tr><tr><td align="right">2.26&nbsp;</td><td><a href="c2e26.html" class="tocviewlink" data-pltdoc="x">Exercise 2.26</a></td></tr><tr><td align="right">2.27&nbsp;</td><td><a href="c2e27.html" class="tocviewlink" data-pltdoc="x">Exercise 2.27</a></td></tr><tr><td align="right">2.28&nbsp;</td><td><a href="c2e28.html" class="tocviewlink" data-pltdoc="x">Exercise 2.28</a></td></tr><tr><td align="right">2.29&nbsp;</td><td><a href="c2e29.html" class="tocviewlink" data-pltdoc="x">Exercise 2.29</a></td></tr><tr><td align="right">2.30&nbsp;</td><td><a href="c2e30.html" class="tocviewlink" data-pltdoc="x">Exercise 2.30</a></td></tr><tr><td align="right">2.31&nbsp;</td><td><a href="c2e31.html" class="tocviewlink" data-pltdoc="x">Exercise 2.31</a></td></tr><tr><td align="right">2.32&nbsp;</td><td><a href="c2e32.html" class="tocviewlink" data-pltdoc="x">Exercise 2.32</a></td></tr><tr><td align="right">2.33&nbsp;</td><td><a href="c2e33.html" class="tocviewlink" data-pltdoc="x">Exercise 2.33</a></td></tr><tr><td align="right">2.34&nbsp;</td><td><a href="c2e34.html" class="tocviewlink" data-pltdoc="x">Exercise 2.34</a></td></tr><tr><td align="right">2.35&nbsp;</td><td><a href="c2e35.html" class="tocviewlink" data-pltdoc="x">Exercise 2.35</a></td></tr><tr><td align="right">2.36&nbsp;</td><td><a href="c2e36.html" class="tocviewlink" data-pltdoc="x">Exercise 2.36</a></td></tr><tr><td align="right">2.37&nbsp;</td><td><a href="c2e37.html" class="tocviewlink" data-pltdoc="x">Exercise 2.37</a></td></tr><tr><td align="right">2.38&nbsp;</td><td><a href="c2e38.html" class="tocviewlink" data-pltdoc="x">Exercise 2.38</a></td></tr><tr><td align="right">2.39&nbsp;</td><td><a href="c2e39.html" class="tocviewlink" data-pltdoc="x">Exercise 2.39</a></td></tr><tr><td align="right">2.40&nbsp;</td><td><a href="c2e40.html" class="tocviewlink" data-pltdoc="x">Exercise 2.40</a></td></tr><tr><td align="right">2.41&nbsp;</td><td><a href="c2e41.html" class="tocviewlink" data-pltdoc="x">Exercise 2.41</a></td></tr><tr><td align="right">2.42&nbsp;</td><td><a href="c2e42.html" class="tocviewlink" data-pltdoc="x">Exercise 2.42</a></td></tr><tr><td align="right">2.43&nbsp;</td><td><a href="c2e43.html" class="tocviewlink" data-pltdoc="x">Exercise 2.43</a></td></tr><tr><td align="right">2.44&nbsp;</td><td><a href="c2e44.html" class="tocviewlink" data-pltdoc="x">Exercise 2.44</a></td></tr><tr><td align="right">2.45&nbsp;</td><td><a href="c2e45.html" class="tocviewlink" data-pltdoc="x">Exercise 2.45</a></td></tr><tr><td align="right">2.46&nbsp;</td><td><a href="c2e46.html" class="tocviewlink" data-pltdoc="x">Exercise 2.46</a></td></tr><tr><td align="right">2.47&nbsp;</td><td><a href="c2e47.html" class="tocviewlink" data-pltdoc="x">Exercise 2.47</a></td></tr><tr><td align="right">2.48&nbsp;</td><td><a href="c2e48.html" class="tocviewlink" data-pltdoc="x">Exercise 2.48</a></td></tr><tr><td align="right">2.49&nbsp;</td><td><a href="c2e49.html" class="tocviewlink" data-pltdoc="x">Exercise 2.49</a></td></tr><tr><td align="right">2.50&nbsp;</td><td><a href="c2e50.html" class="tocviewlink" data-pltdoc="x">Exercise 2.50</a></td></tr><tr><td align="right">2.51&nbsp;</td><td><a href="c2e51.html" class="tocviewlink" data-pltdoc="x">Exercise 2.51</a></td></tr><tr><td align="right">2.52&nbsp;</td><td><a href="c2e52.html" class="tocviewlink" data-pltdoc="x">Exercise 2.52</a></td></tr><tr><td align="right">2.53&nbsp;</td><td><a href="c2e53.html" class="tocviewlink" data-pltdoc="x">Exercise 2.53</a></td></tr><tr><td align="right">2.54&nbsp;</td><td><a href="c2e54.html" class="tocviewlink" data-pltdoc="x">Exercise 2.54</a></td></tr><tr><td align="right">2.55&nbsp;</td><td><a href="c2e55.html" class="tocviewlink" data-pltdoc="x">Exercise 2.55</a></td></tr><tr><td align="right">2.56&nbsp;</td><td><a href="c2e56.html" class="tocviewlink" data-pltdoc="x">Exercise 2.56</a></td></tr><tr><td align="right">2.57&nbsp;</td><td><a href="c2e57.html" class="tocviewlink" data-pltdoc="x">Exercise 2.57</a></td></tr><tr><td align="right">2.58&nbsp;</td><td><a href="c2e58.html" class="tocviewlink" data-pltdoc="x">Exercise 2.58</a></td></tr><tr><td align="right">2.59&nbsp;</td><td><a href="c2e59.html" class="tocviewlink" data-pltdoc="x">Exercise 2.59</a></td></tr><tr><td align="right">2.60&nbsp;</td><td><a href="c2e60.html" class="tocviewlink" data-pltdoc="x">Exercise 2.60</a></td></tr><tr><td align="right">2.61&nbsp;</td><td><a href="c2e61.html" class="tocviewlink" data-pltdoc="x">Exercise 2.61</a></td></tr><tr><td align="right">2.62&nbsp;</td><td><a href="c2e62.html" class="tocviewlink" data-pltdoc="x">Exercise 2.62</a></td></tr><tr><td align="right">2.63&nbsp;</td><td><a href="c2e63.html" class="tocviewlink" data-pltdoc="x">Exercise 2.63</a></td></tr><tr><td align="right">2.64&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Exercise 2.64</a></td></tr><tr><td align="right">2.65&nbsp;</td><td><a href="c2e65.html" class="tocviewlink" data-pltdoc="x">Exercise 2.65</a></td></tr><tr><td align="right">2.66&nbsp;</td><td><a href="c2e66.html" class="tocviewlink" data-pltdoc="x">Exercise 2.66</a></td></tr><tr><td align="right">2.67&nbsp;</td><td><a href="c2e67.html" class="tocviewlink" data-pltdoc="x">Exercise 2.67</a></td></tr><tr><td align="right">2.68&nbsp;</td><td><a href="c2e68.html" class="tocviewlink" data-pltdoc="x">Exercise 2.68</a></td></tr><tr><td align="right">2.69&nbsp;</td><td><a href="c2e69.html" class="tocviewlink" data-pltdoc="x">Exercise 2.69</a></td></tr><tr><td align="right">2.70&nbsp;</td><td><a href="c2e70.html" class="tocviewlink" data-pltdoc="x">Exercise 2.70</a></td></tr><tr><td align="right">2.71&nbsp;</td><td><a href="c2e71.html" class="tocviewlink" data-pltdoc="x">Exercise 2.71</a></td></tr><tr><td align="right">2.72&nbsp;</td><td><a href="c2e72.html" class="tocviewlink" data-pltdoc="x">Exercise 2.72</a></td></tr><tr><td align="right">2.73&nbsp;</td><td><a href="c2e73.html" class="tocviewlink" data-pltdoc="x">Section 2.73</a></td></tr><tr><td align="right">2.74&nbsp;</td><td><a href="c2e74.html" class="tocviewlink" data-pltdoc="x">Exercise 2.74</a></td></tr><tr><td align="right">2.75&nbsp;</td><td><a href="c2e75.html" class="tocviewlink" data-pltdoc="x">Exercise 2.75</a></td></tr><tr><td align="right">2.76&nbsp;</td><td><a href="c2e76.html" class="tocviewlink" data-pltdoc="x">Exercise 2.76</a></td></tr><tr><td align="right">2.77&nbsp;</td><td><a href="c2e77.html" class="tocviewlink" data-pltdoc="x">Exercise 2.77</a></td></tr><tr><td align="right">2.78&nbsp;</td><td><a href="c2e78.html" class="tocviewlink" data-pltdoc="x">Exercise 2.78</a></td></tr><tr><td align="right">2.79&nbsp;</td><td><a href="c2e79.html" class="tocviewlink" data-pltdoc="x">Exercise 2.79</a></td></tr><tr><td align="right">2.80&nbsp;</td><td><a href="c2e80.html" class="tocviewlink" data-pltdoc="x">Exercise 2.80</a></td></tr><tr><td align="right">2.81&nbsp;</td><td><a href="c2e81.html" class="tocviewlink" data-pltdoc="x">Exercise 2.81</a></td></tr><tr><td align="right">2.82&nbsp;</td><td><a href="c2e82.html" class="tocviewlink" data-pltdoc="x">Exercise 2.82</a></td></tr><tr><td align="right">2.83&nbsp;</td><td><a href="c2e83.html" class="tocviewlink" data-pltdoc="x">Exercise 2.83</a></td></tr><tr><td align="right">2.84&nbsp;</td><td><a href="c2e84.html" class="tocviewlink" data-pltdoc="x">Exercise 2.84</a></td></tr><tr><td align="right">2.85&nbsp;</td><td><a href="c2e85.html" class="tocviewlink" data-pltdoc="x">Exercise 2.85</a></td></tr><tr><td align="right">2.86&nbsp;</td><td><a href="c2e86.html" class="tocviewlink" data-pltdoc="x">Exercise 2.86</a></td></tr><tr><td align="right">2.87&nbsp;</td><td><a href="c2e87.html" class="tocviewlink" data-pltdoc="x">Exercise 2.87</a></td></tr><tr><td align="right">2.88&nbsp;</td><td><a href="c2e88.html" class="tocviewlink" data-pltdoc="x">Exercise 2.88</a></td></tr><tr><td align="right">2.89&nbsp;</td><td><a href="c2e89.html" class="tocviewlink" data-pltdoc="x">Exercise 2.89</a></td></tr><tr><td align="right">2.90&nbsp;</td><td><a href="c2e90.html" class="tocviewlink" data-pltdoc="x">Exercise 2.90</a></td></tr><tr><td align="right">2.91&nbsp;</td><td><a href="c2e91.html" class="tocviewlink" data-pltdoc="x">Exercise 2.91</a></td></tr><tr><td align="right">2.92&nbsp;</td><td><a href="c2e92.html" class="tocviewlink" data-pltdoc="x">Exercise 2.92</a></td></tr><tr><td align="right">2.93&nbsp;</td><td><a href="c2e93.html" class="tocviewlink" data-pltdoc="x">Exercise 2.93</a></td></tr><tr><td align="right">2.94&nbsp;</td><td><a href="c2e94.html" class="tocviewlink" data-pltdoc="x">Exercise 2.94</a></td></tr><tr><td align="right">2.95&nbsp;</td><td><a href="c2e95.html" class="tocviewlink" data-pltdoc="x">Exercise 2.95</a></td></tr><tr><td align="right">2.96&nbsp;</td><td><a href="c2e96.html" class="tocviewlink" data-pltdoc="x">Exercise 2.96</a></td></tr><tr><td align="right">2.97&nbsp;</td><td><a href="c2e97.html" class="tocviewlink" data-pltdoc="x">Exercise 2.97</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="c2e63.html" title="backward to &quot;2.63 Exercise 2.63&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Chapter_2.html" title="up to &quot;2 Chapter 2&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="c2e65.html" title="forward to &quot;2.65 Exercise 2.65&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4>2.64<tt>&nbsp;</tt><a name="(part._c2e64)"></a>Exercise 2.64</h4><p><span style="font-weight: bold">NOTE: This is not quite going to be in the form of a "short paragraph". I
hope you understand.</span></p><p>We are asked to explain how the following procedure <span class="stt">partial-tree</span>
works:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">partial-tree</span><span class="hspace">&nbsp;</span><span class="RktSym">elts</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktSym">elts</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">left-size</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">quotient</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">left-result</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">partial-tree</span><span class="hspace">&nbsp;</span><span class="RktSym">elts</span><span class="hspace">&nbsp;</span><span class="RktSym">left-size</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">left-tree</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">left-result</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">non-left-elts</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">left-result</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">right-size</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">left-size</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">this-entry</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">non-left-elts</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">right-result</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">partial-tree</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">non-left-elts</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">right-size</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">right-tree</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">right-result</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remaining-elts</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">right-result</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tree</span><span class="hspace">&nbsp;</span><span class="RktSym">this-entry</span><span class="hspace">&nbsp;</span><span class="RktSym">left-tree</span><span class="hspace">&nbsp;</span><span class="RktSym">right-tree</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">remaining-elts</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p>Before beginning, I would first reformat the procedure using a form we haven&rsquo;t
learned yet, <span class="stt">let*</span>, which allows for earlier bindings available to later
ones. This removes the need for the creeping indentation we see above.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">partial-tree</span><span class="hspace">&nbsp;</span><span class="RktSym">elts</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktSym">elts</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">left-size</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">quotient</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-result</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">partial-tree</span><span class="hspace">&nbsp;</span><span class="RktSym">elts</span><span class="hspace">&nbsp;</span><span class="RktSym">left-size</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">left-tree</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">left-result</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">non-left-elts</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">left-result</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">right-size</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">left-size</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">this-entry</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">non-left-elts</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">right-result</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">partial-tree</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">non-left-elts</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">right-size</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">right-tree</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">right-result</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">remaining-elts</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">right-result</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tree</span><span class="hspace">&nbsp;</span><span class="RktSym">this-entry</span><span class="hspace">&nbsp;</span><span class="RktSym">left-tree</span><span class="hspace">&nbsp;</span><span class="RktSym">right-tree</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">remaining-elts</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p>This procedure is more involved than most we&rsquo;ve worked with so far, but if we
break down what every definition is computing, we can piece together what the
procedure is doing fairly easily. We&rsquo;ll do it line-by-line.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(if (= n 0)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">...)</span></p></td></tr></table></p><p>This sets up the base case of the procedure, which is clearly going to be
recursive.  We can look at the way <span class="stt">partial-tree</span> is called to understand
what the base case means:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(define (list-&gt;tree elements)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(car (partial-tree elements (length elements))))</span></p></td></tr></table></p><p>So <span class="stt">n</span> is the number of elements that this call of <span class="stt">partial-tree</span> is going to
process. If there are none left, then we evaluate</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(cons '() elts)</span></p></td></tr></table></p><p>and return an empty list (meaning an empty tree &ndash; there are no elements left
to add) paired with the <span class="stt">elts</span> we passed to <span class="stt">partial-tree</span>.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(let* ((left-size (quotient (- n 1) 2))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">...))</span></p></td></tr></table></p><p>This sets up the general case. It exists inside a <span class="stt">let*</span> form (or the first
of quite a few regular <span class="stt">let</span>s in the original), giving us a scope to define
values that we will use to get our result. The first of these is <span class="stt">left-size</span>,
which is <span class="stt">(n - 1) / 2</span>. We&rsquo;ll see why we subtract <span class="stt">1</span> later; for now, just
understand that this is our value called <span class="stt">left-size</span>.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(left-result (partial-tree elts left-size))</span></p></td></tr></table></p><p>The value <span class="stt">left-result</span> is given the meaning of the tree representation of
<span class="stt">left-size</span> elements from <span class="stt">elts</span>. Instead of creating a sublist with just
this many elements, we use the <span class="stt">n</span> argument in <span class="stt">partial-tree</span> to regulate
how many elements are taken in all of the recursive calls (as seen here &ndash;
we&rsquo;re only turning the first half of the list into a tree).</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(left-tree (car left-result))</span></p></td></tr><tr><td><p><span class="stt">(non-left-elts (cdr left-result))</span></p></td></tr></table></p><p>We know that <span class="stt">partial-tree</span>, in the base case, returns a pair consisting of
an empty list and the elements passed to it that weren&rsquo;t used in that base
case.  This confirms that, in general, the <span class="stt">car</span> of the pair is the
generated tree (which in the base case is empty) and the <span class="stt">cdr</span> is the
remaining elements (which in the base case is all of them).</p><p>Can we be sure that <span class="stt">non-left-elts</span> will contain the elements not used in
the left side of the tree? We can start to imagine why this might be correct
with a case where <span class="stt">n</span> is equal to <span class="stt">1</span>. Clearly, <span class="stt">left-size</span> will be
<span class="stt">0</span>, making <span class="stt">left-result</span> an empty list, <span class="stt">left-tree</span> an empty tree,
and <span class="stt">non-left-elts</span> contain all of our original elements, none of which are
in <span class="stt">left-tree</span>. The reasons for this behavior will become clearer in a
moment, but it is at least plausible that this works.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(right-size (- n (+ left-size 1)))</span></p></td></tr></table></p><p>This is similar to <span class="stt">left-size</span>, and is probably the number of elements that
are going to be in the right-side tree. And again, we see that the size is not
equal to <span class="stt">n</span> minus <span class="stt">left-size</span>, but is one less than that. In other words,
<span class="stt">left-size</span> and <span class="stt">right-size</span>, moving inward, leave one element in the middle of
the list. And what is this used for? We can see in the next line:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(this-entry (car non-left-elts))</span></p></td></tr></table></p><p>We assign the first element in <span class="stt">non-left-elts</span> to a new value,
<span class="stt">this-entry</span>. It is reasonable to suspect that this is going to be the root
of the tree. This makes it obvious why the sizes of the left and right branches
leave space for one more element &ndash; of course the root element of a tree can&rsquo;t
be in either of its subtrees. This is what happens to the first element of
<span class="stt">elts</span> in the case considered above, where <span class="stt">n</span> is <span class="stt">1</span> &ndash; exactly as we
would expect.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(right-result (partial-tree (cdr non-left-elts) right-size))</span></p></td></tr></table></p><p>This computes the right side of the tree, using <span class="stt">right-size</span> and the elements of
<span class="stt">non-left-elts</span> following the root of the tree.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(right-tree (car right-result))</span></p></td></tr><tr><td><p><span class="stt">(remaining-elts (cdr right-result))</span></p></td></tr></table></p><p>These correspond to the definitions earlier, getting the computed tree and the elements
not used it in from the pair produced by <span class="stt">partial-tree</span>.</p><p>Having now processed all of the bindings in the <span class="stt">let*</span> expression, we only have
the body of the procedure left:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(cons (make-tree this-entry left-tree right-tree) remaining-elts)</span></p></td></tr></table></p><p>This is just the general case of the result we saw earlier in the base case, and have
used twice in the procedure so far. By this time, it should be clear how it works.</p><p>Evaluating <span class="stt">list-&gt;tree</span> on the given list, we get the following tree:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">(5</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(1 ()</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(3 () ()))</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(9 (7 () ())</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(11 () ())))</span></p></td></tr></table></p><p>Or, in a particularly bad graphical style,</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">5</span></p></td></tr><tr><td><p><span class="stt">|- 1</span></p></td></tr><tr><td><p><span class="stt">|</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">|- 3</span></p></td></tr><tr><td><p><span class="stt">|</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">|-</span></p></td></tr><tr><td><p><span class="stt">|</span></p></td></tr><tr><td><p><span class="stt">|- 9</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">|- 7</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">|- 11</span></p></td></tr></table></p><p><span class="stt">***</span></p><p>Now that we understand how the procedure works, what is the order of growth in
time complexity? Actually, it&rsquo;s rather easy. Even though we have recursive
calls to <span class="stt">partial-tree</span>, we are careful to only visit every element of the
list once. Once elements are added to a tree, they are never visited again, and
elements that haven&rsquo;t been added to the tree yet are not visited until they are
explicitly added to it. And elements are added to the tree with an <span class="stt">O(1)</span>
<span class="stt">cons</span>. Therefore, the procedure has an order of growth in execution time of
<span class="stt">O(N)</span>.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="c2e63.html" title="backward to &quot;2.63 Exercise 2.63&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Chapter_2.html" title="up to &quot;2 Chapter 2&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="c2e65.html" title="forward to &quot;2.65 Exercise 2.65&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>