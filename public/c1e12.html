<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>1.12&nbsp;Exercise 1.12</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">zthomae&rsquo;s SICP solutions</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Chapter_1.html" class="tocviewselflink" data-pltdoc="x">Chapter 1</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Chapter_2.html" class="tocviewlink" data-pltdoc="x">Chapter 2</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Chapter_3.html" class="tocviewlink" data-pltdoc="x">Chapter 3</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Chapter_4.html" class="tocviewlink" data-pltdoc="x">Chapter 4</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>1&nbsp;</td><td><a href="Chapter_1.html" class="tocviewlink" data-pltdoc="x">Chapter 1</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">1.1&nbsp;</td><td><a href="c1e1.html" class="tocviewlink" data-pltdoc="x">Exercise 1.1</a></td></tr><tr><td align="right">1.2&nbsp;</td><td><a href="c1e2.html" class="tocviewlink" data-pltdoc="x">Exercise 1.2</a></td></tr><tr><td align="right">1.3&nbsp;</td><td><a href="c1e3.html" class="tocviewlink" data-pltdoc="x">Exercise 1.3</a></td></tr><tr><td align="right">1.4&nbsp;</td><td><a href="c1e4.html" class="tocviewlink" data-pltdoc="x">Exercise 1.4</a></td></tr><tr><td align="right">1.5&nbsp;</td><td><a href="c1e5.html" class="tocviewlink" data-pltdoc="x">Exercise 1.5</a></td></tr><tr><td align="right">1.6&nbsp;</td><td><a href="c1e6.html" class="tocviewlink" data-pltdoc="x">Exercise 1.6</a></td></tr><tr><td align="right">1.7&nbsp;</td><td><a href="c1e7.html" class="tocviewlink" data-pltdoc="x">Exercise 1.7</a></td></tr><tr><td align="right">1.8&nbsp;</td><td><a href="c1e8.html" class="tocviewlink" data-pltdoc="x">Exercise 1.8</a></td></tr><tr><td align="right">1.9&nbsp;</td><td><a href="c1e9.html" class="tocviewlink" data-pltdoc="x">Exercise 1.9</a></td></tr><tr><td align="right">1.10&nbsp;</td><td><a href="c1e10.html" class="tocviewlink" data-pltdoc="x">Exercise 1.10</a></td></tr><tr><td align="right">1.11&nbsp;</td><td><a href="c1e11.html" class="tocviewlink" data-pltdoc="x">Exercise 1.11</a></td></tr><tr><td align="right">1.12&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Exercise 1.12</a></td></tr><tr><td align="right">1.13&nbsp;</td><td><a href="c1e13.html" class="tocviewlink" data-pltdoc="x">Exercise 1.13</a></td></tr><tr><td align="right">1.14&nbsp;</td><td><a href="c1e14.html" class="tocviewlink" data-pltdoc="x">Exercise 1.14</a></td></tr><tr><td align="right">1.15&nbsp;</td><td><a href="c1e15.html" class="tocviewlink" data-pltdoc="x">Exercise 1.15</a></td></tr><tr><td align="right">1.16&nbsp;</td><td><a href="c1e16.html" class="tocviewlink" data-pltdoc="x">Exercise 1.16</a></td></tr><tr><td align="right">1.17&nbsp;</td><td><a href="c1e17.html" class="tocviewlink" data-pltdoc="x">Exercise 1.17</a></td></tr><tr><td align="right">1.18&nbsp;</td><td><a href="c1e18.html" class="tocviewlink" data-pltdoc="x">Exercise 1.18</a></td></tr><tr><td align="right">1.19&nbsp;</td><td><a href="c1e19.html" class="tocviewlink" data-pltdoc="x">Exercise 1.19</a></td></tr><tr><td align="right">1.20&nbsp;</td><td><a href="c1e20.html" class="tocviewlink" data-pltdoc="x">Exercise 1.20</a></td></tr><tr><td align="right">1.21&nbsp;</td><td><a href="c1e21.html" class="tocviewlink" data-pltdoc="x">Exercise 1.21</a></td></tr><tr><td align="right">1.22&nbsp;</td><td><a href="c1e22.html" class="tocviewlink" data-pltdoc="x">Exercise 1.22</a></td></tr><tr><td align="right">1.23&nbsp;</td><td><a href="c1e23.html" class="tocviewlink" data-pltdoc="x">Exercise 1.23</a></td></tr><tr><td align="right">1.24&nbsp;</td><td><a href="c1e24.html" class="tocviewlink" data-pltdoc="x">Exercise 1.24</a></td></tr><tr><td align="right">1.25&nbsp;</td><td><a href="c1e25.html" class="tocviewlink" data-pltdoc="x">Exercise 1.25</a></td></tr><tr><td align="right">1.26&nbsp;</td><td><a href="c1e26.html" class="tocviewlink" data-pltdoc="x">Exercise 1.26</a></td></tr><tr><td align="right">1.27&nbsp;</td><td><a href="c1e27.html" class="tocviewlink" data-pltdoc="x">Exercise 1.27</a></td></tr><tr><td align="right">1.28&nbsp;</td><td><a href="c1e28.html" class="tocviewlink" data-pltdoc="x">Exercise 1.28</a></td></tr><tr><td align="right">1.29&nbsp;</td><td><a href="c1e29.html" class="tocviewlink" data-pltdoc="x">Exercise 1.29</a></td></tr><tr><td align="right">1.30&nbsp;</td><td><a href="c1e30.html" class="tocviewlink" data-pltdoc="x">Exercise 1.30</a></td></tr><tr><td align="right">1.31&nbsp;</td><td><a href="c1e31.html" class="tocviewlink" data-pltdoc="x">Exercise 1.31</a></td></tr><tr><td align="right">1.32&nbsp;</td><td><a href="c1e32.html" class="tocviewlink" data-pltdoc="x">Exercise 1.32</a></td></tr><tr><td align="right">1.33&nbsp;</td><td><a href="c1e33.html" class="tocviewlink" data-pltdoc="x">Exercise 1.33</a></td></tr><tr><td align="right">1.34&nbsp;</td><td><a href="c1e34.html" class="tocviewlink" data-pltdoc="x">Exercise 1.34</a></td></tr><tr><td align="right">1.35&nbsp;</td><td><a href="c1e35.html" class="tocviewlink" data-pltdoc="x">Exercise 1.35</a></td></tr><tr><td align="right">1.36&nbsp;</td><td><a href="c1e36.html" class="tocviewlink" data-pltdoc="x">Exercise 1.36</a></td></tr><tr><td align="right">1.37&nbsp;</td><td><a href="c1e37.html" class="tocviewlink" data-pltdoc="x">Exercise 1.37</a></td></tr><tr><td align="right">1.38&nbsp;</td><td><a href="c1e38.html" class="tocviewlink" data-pltdoc="x">Exercise 1.38</a></td></tr><tr><td align="right">1.39&nbsp;</td><td><a href="c1e39.html" class="tocviewlink" data-pltdoc="x">Exercise 1.39</a></td></tr><tr><td align="right">1.40&nbsp;</td><td><a href="c1e40.html" class="tocviewlink" data-pltdoc="x">Exercise 1.40</a></td></tr><tr><td align="right">1.41&nbsp;</td><td><a href="c1e41.html" class="tocviewlink" data-pltdoc="x">Exercise 1.41</a></td></tr><tr><td align="right">1.42&nbsp;</td><td><a href="c1e42.html" class="tocviewlink" data-pltdoc="x">Exercise 1.42</a></td></tr><tr><td align="right">1.43&nbsp;</td><td><a href="c1e43.html" class="tocviewlink" data-pltdoc="x">Exercise 1.43</a></td></tr><tr><td align="right">1.44&nbsp;</td><td><a href="c1e44.html" class="tocviewlink" data-pltdoc="x">Exercise 1.44</a></td></tr><tr><td align="right">1.45&nbsp;</td><td><a href="c1e45.html" class="tocviewlink" data-pltdoc="x">Exercise 1.45</a></td></tr><tr><td align="right">1.46&nbsp;</td><td><a href="c1e46.html" class="tocviewlink" data-pltdoc="x">Exercise 1.46</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="c1e11.html" title="backward to &quot;1.11 Exercise 1.11&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Chapter_1.html" title="up to &quot;1 Chapter 1&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="c1e13.html" title="forward to &quot;1.13 Exercise 1.13&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4>1.12<tt>&nbsp;</tt><a name="(part._c1e12)"></a>Exercise 1.12</h4><p>This procedure calculates the value in Pascal&rsquo;s triangle at
depth <span class="stt">depth</span> and column <span class="stt">column</span>. Both the depth and
column are 0-indexed.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-value</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-value</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-value</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p>We can define two more procedures to (primitively) print the
triangle:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-new-row</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-append</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">number-&gt;string</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-value</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">col</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">""</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascals-triangle</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-pascal-triangle</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="hspace">&nbsp;</span><span class="RktVal">""</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p>However, I&rsquo;m not satisfied with this recursive solution. It is
clear to me that, instead of tree-recursively generating every
value in the tree individually, we can generate the next row
of the tree given the bottom row in the current one. We can do
this by storing the tree as a list of lists (where new rows are
added to the <span style="font-weight: bold">front</span> of the list), and making new rows of
the tree by making a list of all the pairs of values in the last
row and mapping <span class="stt">+</span> over them.</p><p>Of course, I could&rsquo;ve also calculated values using binomial coefficients
by row, but I&rsquo;m more interested in treating this like a data structure
juggling problem. Constructing and extending lists of lists can
be tricky (especially since we don&rsquo;t have mutation yet), and it
happens that this is a good problem for exploring one way to do this.</p><p>It is crucial to the simplicity of implementation that the lists
of lists be constructed by prepending &ndash; making a new list by
<span class="stt">cons</span>ing the new inner list with the old list itself. I haven&rsquo;t
bothered to reverse the rows of the entire tree, so it appears
upside-down &ndash; but luckily for us, every row is the same forwards
and backwards, so this construction has no effect on the tree
itself.</p><p>I much prefer having a data structure holding an instance of
Pascal&rsquo;s triangle collected and returned. It seems to me that writing
procedures consuming this structure can be more general than those
that need to directly generate values in the triangle themselves, as
seen above.</p><p>There is a trick in <span class="stt">make-pairs</span>: I add a new pair <span class="stt"></span><span class="stt">&rsquo;</span><span class="stt">(0 1)</span> to the front
and back of the pairs list. This is done to automatically generate the
<span class="stt">1</span>s on the outside of the triangle without special cases. Also, <span class="stt">make-pairs</span>
will generate no pairs other than these padding ones for the row at depth <span class="stt">0</span>,
<span class="stt"></span><span class="stt">&rsquo;</span><span class="stt">(1)</span>, because <span class="stt">(cdr </span><span class="stt">&rsquo;</span><span class="stt">(1))</span> is <span class="stt">null</span>.</p><p>Unlike the exercise directs, this procedure also generates an iterative
process.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">empty?</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">eq?</span><span class="hspace">&nbsp;</span><span class="RktSym">nil</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">pascal-triangle</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-pairs</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="hspace">&nbsp;</span><span class="RktSym">pairs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">null?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktSym">pairs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cadr</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">pairs</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktSym">l</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">compute-next-row</span><span class="hspace">&nbsp;</span><span class="RktSym">row</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">empty?</span><span class="hspace">&nbsp;</span><span class="RktSym">row</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cadr</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-pairs</span><span class="hspace">&nbsp;</span><span class="RktSym">row</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">triangle-loop</span><span class="hspace">&nbsp;</span><span class="RktSym">current-depth</span><span class="hspace">&nbsp;</span><span class="RktSym">current-triangle</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">current-depth</span><span class="hspace">&nbsp;</span><span class="RktSym">depth</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">current-triangle</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">triangle-loop</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">current-depth</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">compute-next-row</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">current-triangle</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">current-triangle</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">triangle-loop</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="c1e11.html" title="backward to &quot;1.11 Exercise 1.11&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Chapter_1.html" title="up to &quot;1 Chapter 1&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="c1e13.html" title="forward to &quot;1.13 Exercise 1.13&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>