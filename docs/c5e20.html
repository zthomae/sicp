<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>5.20&nbsp;Exercise 5.20</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">zthomae&rsquo;s SICP solutions</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Chapter_1.html" class="tocviewlink" data-pltdoc="x">Chapter 1</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Chapter_2.html" class="tocviewlink" data-pltdoc="x">Chapter 2</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Chapter_3.html" class="tocviewlink" data-pltdoc="x">Chapter 3</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Chapter_4.html" class="tocviewlink" data-pltdoc="x">Chapter 4</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Chapter_5.html" class="tocviewselflink" data-pltdoc="x">Chapter 5</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>5&nbsp;</td><td><a href="Chapter_5.html" class="tocviewlink" data-pltdoc="x">Chapter 5</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">5.1&nbsp;</td><td><a href="c5e0.html" class="tocviewlink" data-pltdoc="x">Note on diagrams</a></td></tr><tr><td align="right">5.2&nbsp;</td><td><a href="c5e2.html" class="tocviewlink" data-pltdoc="x">Exercise 5.2</a></td></tr><tr><td align="right">5.3&nbsp;</td><td><a href="c5e3.html" class="tocviewlink" data-pltdoc="x">Exercise 5.3</a></td></tr><tr><td align="right">5.4&nbsp;</td><td><a href="c5e4.html" class="tocviewlink" data-pltdoc="x">Exercise 5.4</a></td></tr><tr><td align="right">5.5&nbsp;</td><td><a href="c5e5.html" class="tocviewlink" data-pltdoc="x">Exercise 5.5</a></td></tr><tr><td align="right">5.6&nbsp;</td><td><a href="c5e6.html" class="tocviewlink" data-pltdoc="x">Exercise 5.6</a></td></tr><tr><td align="right">5.7&nbsp;</td><td><a href="c5e7.html" class="tocviewlink" data-pltdoc="x">Exercise 5.7</a></td></tr><tr><td align="right">5.8&nbsp;</td><td><a href="c5e8.html" class="tocviewlink" data-pltdoc="x">Exercise 5.8</a></td></tr><tr><td align="right">5.9&nbsp;</td><td><a href="c5e9.html" class="tocviewlink" data-pltdoc="x">Exercise 5.9</a></td></tr><tr><td align="right">5.10&nbsp;</td><td><a href="c5e10.html" class="tocviewlink" data-pltdoc="x">Exercise 5.10</a></td></tr><tr><td align="right">5.11&nbsp;</td><td><a href="c5e11.html" class="tocviewlink" data-pltdoc="x">Exercise 5.11</a></td></tr><tr><td align="right">5.12&nbsp;</td><td><a href="c5e12.html" class="tocviewlink" data-pltdoc="x">Exercise 5.12</a></td></tr><tr><td align="right">5.13&nbsp;</td><td><a href="c5e13.html" class="tocviewlink" data-pltdoc="x">Exercise 5.13</a></td></tr><tr><td align="right">5.14&nbsp;</td><td><a href="c5e14.html" class="tocviewlink" data-pltdoc="x">Exercise 5.14</a></td></tr><tr><td align="right">5.15&nbsp;</td><td><a href="c5e15.html" class="tocviewlink" data-pltdoc="x">Exercise 5.15</a></td></tr><tr><td align="right">5.16&nbsp;</td><td><a href="c5e16.html" class="tocviewlink" data-pltdoc="x">Exercise 5.16</a></td></tr><tr><td align="right">5.17&nbsp;</td><td><a href="c5e17.html" class="tocviewlink" data-pltdoc="x">Exercise 5.17</a></td></tr><tr><td align="right">5.18&nbsp;</td><td><a href="c5e18.html" class="tocviewlink" data-pltdoc="x">Exercise 5.18</a></td></tr><tr><td align="right">5.19&nbsp;</td><td><a href="c5e19.html" class="tocviewlink" data-pltdoc="x">Exercise 5.19</a></td></tr><tr><td align="right">5.20&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Exercise 5.20</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="c5e19.html" title="backward to &quot;5.19 Exercise 5.19&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Chapter_5.html" title="up to &quot;5 Chapter 5&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h4>5.20<tt>&nbsp;</tt><a name="(part._c5e20)"></a>Exercise 5.20</h4><p>We are asked to draw box-and-pointer and memory representations of the following list:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Additionally, we are told that the <span class="stt">free</span> pointer is initially at <span class="stt">p1</span>.</p><p>If we perform these allocations in order, then we will first put a <span class="stt">cons</span>
cell with the number 1 in both the <span class="stt">car</span> and <span class="stt">cdr</span> slots in slot <span class="stt">p1</span>.
I believe this is uncontroversial &ndash; we may not have a list, but <span class="stt">car</span> and
<span class="stt">cdr</span> of any kind of pair are straightforward.</p><p>Next, we should add a <span class="stt">cons</span> cell with the <span class="stt">car</span> pointing at <span class="stt">p0</span> and the
<span class="stt">cdr</span> slot pointing to the empty list <span class="stt">e0</span>. I believe that the most reasonable
way to fill out memory when constructing lists with the <span class="stt">list</span> operator is to
construct them in reverse order, with the last <span class="stt">cons</span> cell being allocated first.
This is easier to implement because it allows the earlier cells to refer to cells
that have already been created. This will also let us take advantage of the normal
incrementing of the <span class="stt">free</span> pointer.</p><p>It follows that we place the next (and first) <span class="stt">cons</span> cell of <span class="stt">y</span> in
slot <span class="stt">p3</span>. This points to <span class="stt">p0</span> in the <span class="stt">car</span> position and <span class="stt">p2</span> in
the <span class="stt">cdr</span> position.</p><p>After we&rsquo;re done, the <span class="stt">free</span> pointer is at position <span class="stt">p4</span>.</p><p>Diagrams follow:</p><p><img src="5-20_box-pointer.png" alt="" width="391" height="441"/></p><p><img src="5-20_memory.png" alt="" width="859" height="77"/></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="c5e19.html" title="backward to &quot;5.19 Exercise 5.19&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Chapter_5.html" title="up to &quot;5 Chapter 5&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>